<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MECADEPOT ERP — Prototype Interactif</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' rx='6' fill='%230F172A'/><text x='50%25' y='55%25' dominant-baseline='middle' text-anchor='middle' font-size='18' font-weight='900' fill='%23E8B931'>M</text></svg>">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',-apple-system,BlinkMacSystemFont,sans-serif;background:#F1F5F9;overflow:hidden}
#root{height:100vh}
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:#CBD5E1;border-radius:3px}
select,input,button{font-family:inherit}table{border-spacing:0}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}.fade-in{animation:fadeIn .3s ease-out}
.sidebar-btn:hover{background:rgba(255,255,255,0.05)!important}.tbl-row:hover{background:#F8FAFC!important}.btn-hover:hover{opacity:0.85}
#loading{display:flex;align-items:center;justify-content:center;height:100vh;background:#0F172A;color:#fff;font-size:18px;font-weight:600;flex-direction:column;gap:12px}
.spinner{width:40px;height:40px;border:4px solid #1E293B;border-top-color:#E8B931;border-radius:50%;animation:spin 0.8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>
<body>
<div id="root"><div id="loading"><div class="spinner"></div>Chargement MECADEPOT ERP...</div></div>

<script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>

<script type="module">
import htm from 'https://esm.sh/htm@3.1.1';
const html = htm.bind(React.createElement);
const {useState, useEffect} = React;

const PRODUCTS=[
{id:"P001",ref:"BRK-PAD-4520",ean:"3660210451230",name:"Plaquettes frein AV Bosch",cat:"Freinage",brand:"Bosch",priceHT:34.50,costHT:18.20,stock:45,minStock:10},
{id:"P002",ref:"FLT-OIL-7831",ean:"3660210783115",name:"Filtre huile Mann HU719/7x",cat:"Filtration",brand:"Mann",priceHT:12.80,costHT:5.60,stock:120,minStock:25},
{id:"P003",ref:"AMR-FRT-2290",ean:"3660210229064",name:"Amortisseur AV Sachs",cat:"Suspension",brand:"Sachs",priceHT:89.00,costHT:42.50,stock:8,minStock:5},
{id:"P004",ref:"DSC-BRK-1850",ean:"3660210185023",name:"Disque frein AV Brembo",cat:"Freinage",brand:"Brembo",priceHT:56.90,costHT:28.40,stock:22,minStock:8},
{id:"P005",ref:"BUG-ALM-9920",ean:"3660210992017",name:"Bougie allumage NGK",cat:"Allumage",brand:"NGK",priceHT:8.50,costHT:2.80,stock:200,minStock:50},
{id:"P006",ref:"CRR-DST-3380",ean:"3660210338056",name:"Courroie distribution Gates",cat:"Distribution",brand:"Gates",priceHT:145.00,costHT:68.00,stock:3,minStock:5},
{id:"P007",ref:"PLQ-ARR-6610",ean:"3660210661089",name:"Plaquettes frein AR TRW",cat:"Freinage",brand:"TRW",priceHT:28.90,costHT:14.20,stock:38,minStock:10},
{id:"P008",ref:"FLT-AIR-4450",ean:"3660210445032",name:"Filtre air Mahle LX1566",cat:"Filtration",brand:"Mahle",priceHT:18.50,costHT:7.80,stock:67,minStock:15}];
const SUPPLIERS=[{id:"S1",name:"Alliance Automotive",type:"REST",status:"active",priority:1},{id:"S2",name:"Autodistribution",type:"REST",status:"active",priority:2},{id:"S3",name:"PHE (Parts Hub Europe)",type:"SOAP",status:"active",priority:3},{id:"S4",name:"Distrigo (Stellantis)",type:"REST",status:"active",priority:4},{id:"S5",name:"TecAlliance Direct",type:"REST",status:"warning",priority:5}];
const ORDERS=[{id:"CMD-2026-00142",client:"Garage Martin SAS",status:"DELIVERED",total:456.80,date:"2026-02-04",items:5,source:"B2B"},{id:"CMD-2026-00141",client:"Auto Service Plus",status:"READY",total:234.50,date:"2026-02-04",items:3,source:"B2B"},{id:"CMD-2026-00140",client:"Client comptoir",status:"DELIVERED",total:67.40,date:"2026-02-04",items:2,source:"POS"},{id:"CMD-2026-00139",client:"MecaPro SARL",status:"PREPARING",total:892.10,date:"2026-02-03",items:8,source:"B2B"},{id:"CMD-2026-00138",client:"Garage du Pont",status:"CONFIRMED",total:345.60,date:"2026-02-03",items:4,source:"INTERNAL"},{id:"CMD-2026-00137",client:"Client comptoir",status:"DELIVERED",total:28.90,date:"2026-02-03",items:1,source:"POS"},{id:"CMD-2026-00136",client:"AutoFix Express",status:"CANCELLED",total:156.00,date:"2026-02-02",items:2,source:"B2B"},{id:"CMD-2026-00135",client:"Garage Martin SAS",status:"DELIVERED",total:1240.00,date:"2026-02-02",items:12,source:"B2B"}];
const INVOICES=[{id:"INV-2026-00089",order:"CMD-2026-00142",client:"Garage Martin SAS",total:548.16,status:"SENT",date:"2026-02-04",pdp:"Transmise"},{id:"INV-2026-00088",order:"CMD-2026-00140",client:"Client comptoir",total:80.88,status:"ISSUED",date:"2026-02-04",pdp:"En attente"},{id:"INV-2026-00087",order:"CMD-2026-00137",client:"Client comptoir",total:34.68,status:"SENT",date:"2026-02-03",pdp:"Transmise"},{id:"INV-2026-00086",order:"CMD-2026-00135",client:"Garage Martin SAS",total:1488.00,status:"SENT",date:"2026-02-02",pdp:"Reçue"}];
const QUOTES=[{id:"DEV-2026-00034",client:"Carrosserie Dupont",status:"SENT",total:2340.00,date:"2026-02-03",validUntil:"2026-03-05"},{id:"DEV-2026-00033",client:"AutoFix Express",status:"ACCEPTED",total:456.80,date:"2026-02-01",validUntil:"2026-03-03"},{id:"DEV-2026-00032",client:"Garage du Pont",status:"DRAFT",total:890.00,date:"2026-01-30",validUntil:"2026-03-01"}];
const CUSTOMERS=[{id:"C001",name:"Garage Martin SAS",type:"B2B",grid:"PRO-15",city:"Saint-Antoine",orders:45,ca:34500},{id:"C002",name:"Auto Service Plus",type:"B2B",grid:"PRO-10",city:"Lyon",orders:23,ca:18200},{id:"C003",name:"MecaPro SARL",type:"B2B",grid:"PRO-20",city:"Marseille",orders:67,ca:52800},{id:"C004",name:"Garage du Pont",type:"B2B",grid:"STD",city:"Grenoble",orders:12,ca:8900},{id:"C005",name:"AutoFix Express",type:"B2B",grid:"PRO-10",city:"Nice",orders:8,ca:5600},{id:"C006",name:"Carrosserie Dupont",type:"B2B",grid:"STD",city:"Toulouse",orders:3,ca:2400}];
const RETURNS=[{id:"RET-2026-00012",order:"CMD-2026-00128",client:"Auto Service Plus",status:"APPROVED",reason:"Pièce incompatible",date:"2026-02-03"},{id:"RET-2026-00011",order:"CMD-2026-00125",client:"Garage Martin SAS",status:"RECEIVED",reason:"Défaut fabrication",date:"2026-02-01"},{id:"RET-2026-00010",order:"CMD-2026-00120",client:"MecaPro SARL",status:"REFUNDED",reason:"Erreur référence",date:"2026-01-28"}];

const ROLES={OWNER:{label:"OWNER",desc:"Propriétaire",icon:"\u{1F451}",color:"#E8B931"},ADMIN:{label:"ADMIN",desc:"Administrateur",icon:"\u2699\uFE0F",color:"#8B5CF6"},MANAGER:{label:"MANAGER",desc:"Responsable",icon:"\u{1F4CA}",color:"#3B82F6"},COMMERCIAL:{label:"COMMERCIAL",desc:"Commercial",icon:"\u{1F91D}",color:"#10B981"},COUNTER_AGENT:{label:"COUNTER",desc:"Agent comptoir",icon:"\u{1F3EA}",color:"#F59E0B"},WAREHOUSE_KEEPER:{label:"WAREHOUSE",desc:"Magasinier",icon:"\u{1F4E6}",color:"#EF4444"},ACCOUNTING:{label:"ACCOUNTING",desc:"Comptable",icon:"\u{1F4B0}",color:"#6366F1"},PURCHASER:{label:"PURCHASER",desc:"Acheteur",icon:"\u{1F6D2}",color:"#EC4899"},B2B_OWNER:{label:"B2B_OWNER",desc:"Admin client B2B",icon:"\u{1F3E2}",color:"#14B8A6"},B2B_BUYER:{label:"B2B_BUYER",desc:"Acheteur B2B",icon:"\u{1F6CD}\uFE0F",color:"#06B6D4"},B2B_VIEWER:{label:"B2B_VIEWER",desc:"Consultant B2B",icon:"\u{1F441}\uFE0F",color:"#64748B"}};
const MENU_BY_ROLE={OWNER:["dashboard","orders","orders-new","quotes","customers","catalog","inventory","invoices","credit-notes","returns","pos","suppliers","admin-users","admin-settings","admin-pricing","admin-logs","exports"],ADMIN:["admin-users","admin-settings","admin-pricing","admin-logs","suppliers","suppliers-api","products"],MANAGER:["dashboard","orders","orders-new","quotes","customers","catalog","inventory","returns","invoices","credit-notes","pos"],COMMERCIAL:["dashboard","catalog","orders-new","orders","quotes","customers","inventory","invoices","returns"],COUNTER_AGENT:["pos","orders-new","orders","catalog","inventory"],WAREHOUSE_KEEPER:["warehouse-deliveries","warehouse-receptions","inventory","inventory-receive","returns"],ACCOUNTING:["invoices","credit-notes","exports","orders","returns"],PURCHASER:["suppliers","supplier-orders","inventory-receive","purchase-orders"],B2B_OWNER:["b2b-dashboard","b2b-catalog","b2b-orders","b2b-orders-new","b2b-invoices","b2b-users","b2b-profile"],B2B_BUYER:["b2b-dashboard","b2b-catalog","b2b-orders","b2b-orders-new","b2b-invoices","b2b-profile"],B2B_VIEWER:["b2b-dashboard","b2b-catalog","b2b-orders","b2b-invoices","b2b-profile"]};
const SM={"dashboard":{label:"Dashboard",icon:"\u{1F4CA}",group:"Général"},"orders":{label:"Commandes",icon:"\u{1F4CB}",group:"Ventes"},"orders-new":{label:"Nouvelle commande",icon:"\u2795",group:"Ventes"},"quotes":{label:"Devis",icon:"\u{1F4DD}",group:"Ventes"},"customers":{label:"Clients",icon:"\u{1F465}",group:"Ventes"},"catalog":{label:"Catalogue",icon:"\u{1F50D}",group:"Produits"},"products":{label:"Produits",icon:"\u{1F4E6}",group:"Produits"},"inventory":{label:"Stock",icon:"\u{1F3ED}",group:"Stock"},"inventory-receive":{label:"Réception",icon:"\u{1F4E5}",group:"Stock"},"invoices":{label:"Factures",icon:"\u{1F9FE}",group:"Finance"},"credit-notes":{label:"Avoirs",icon:"\u21A9\uFE0F",group:"Finance"},"exports":{label:"Exports",icon:"\u{1F4E4}",group:"Finance"},"returns":{label:"Retours",icon:"\u{1F504}",group:"SAV"},"pos":{label:"Caisse / POS",icon:"\u{1F3EA}",group:"POS"},"suppliers":{label:"Fournisseurs",icon:"\u{1F69B}",group:"Achats"},"suppliers-api":{label:"APIs",icon:"\u{1F50C}",group:"Achats"},"supplier-orders":{label:"Cmd Fourn.",icon:"\u{1F4D1}",group:"Achats"},"purchase-orders":{label:"Bons cmd",icon:"\u{1F4C4}",group:"Achats"},"warehouse-deliveries":{label:"Préparations",icon:"\u{1F4E6}",group:"Entrepôt"},"warehouse-receptions":{label:"Réceptions",icon:"\u{1F4E5}",group:"Entrepôt"},"admin-users":{label:"Utilisateurs",icon:"\u{1F464}",group:"Admin"},"admin-settings":{label:"Paramètres",icon:"\u2699\uFE0F",group:"Admin"},"admin-pricing":{label:"Grilles tarif.",icon:"\u{1F4B2}",group:"Admin"},"admin-logs":{label:"Logs audit",icon:"\u{1F4DC}",group:"Admin"},"b2b-dashboard":{label:"Tableau de bord",icon:"\u{1F4CA}",group:"Portail B2B"},"b2b-catalog":{label:"Catalogue",icon:"\u{1F50D}",group:"Portail B2B"},"b2b-orders":{label:"Mes commandes",icon:"\u{1F4CB}",group:"Portail B2B"},"b2b-orders-new":{label:"Commander",icon:"\u{1F6D2}",group:"Portail B2B"},"b2b-invoices":{label:"Mes factures",icon:"\u{1F9FE}",group:"Portail B2B"},"b2b-users":{label:"Utilisateurs",icon:"\u{1F465}",group:"Portail B2B"},"b2b-profile":{label:"Mon profil",icon:"\u{1F3E2}",group:"Portail B2B"}};
const SC={CREATED:{bg:"#DBEAFE",t:"#1E40AF"},CONFIRMED:{bg:"#FEF3C7",t:"#92400E"},PREPARING:{bg:"#FDE68A",t:"#78350F"},READY:{bg:"#D1FAE5",t:"#065F46"},DELIVERED:{bg:"#A7F3D0",t:"#047857"},CANCELLED:{bg:"#FEE2E2",t:"#991B1B"},DRAFT:{bg:"#E5E7EB",t:"#374151"},SENT:{bg:"#DBEAFE",t:"#1E40AF"},ACCEPTED:{bg:"#D1FAE5",t:"#065F46"},ISSUED:{bg:"#FEF3C7",t:"#92400E"},APPROVED:{bg:"#DBEAFE",t:"#1E40AF"},RECEIVED:{bg:"#D1FAE5",t:"#065F46"},REFUNDED:{bg:"#C4B5FD",t:"#5B21B6"}};

/* Components */
const B=({s})=>{const c=SC[s]||{bg:"#E5E7EB",t:"#374151"};return html`<span style=${{background:c.bg,color:c.t,padding:"3px 10px",borderRadius:20,fontSize:11,fontWeight:700,whiteSpace:"nowrap"}}>${s}</span>`;};
const Cd=({children,style:st})=>html`<div class="fade-in" style=${{background:"#fff",borderRadius:10,border:"1px solid #E5E7EB",padding:20,...(st||{})}}>${children}</div>`;
const SC2=({label,value,sub,color,icon})=>html`<${Cd} style=${{flex:1,minWidth:155}}><div style=${{display:"flex",justifyContent:"space-between"}}><div><div style=${{fontSize:11,color:"#6B7280",fontWeight:600,marginBottom:4,textTransform:"uppercase",letterSpacing:.5}}>${label}</div><div style=${{fontSize:24,fontWeight:800,color:color||"#111827",lineHeight:1.1}}>${value}</div>${sub&&html`<div style=${{fontSize:11,color:"#9CA3AF",marginTop:4}}>${sub}</div>`}</div><div style=${{fontSize:26,opacity:.6}}>${icon}</div></div><//>`;
const DT=({cols,rows})=>html`<div style=${{overflowX:"auto",border:"1px solid #E5E7EB",borderRadius:8}}><table style=${{width:"100%",borderCollapse:"collapse",fontSize:13}}><thead><tr style=${{background:"#F8FAFC"}}>${cols.map((c,i)=>html`<th key=${i} style=${{padding:"10px 14px",textAlign:"left",fontWeight:600,color:"#475569",borderBottom:"2px solid #E2E8F0",fontSize:11,textTransform:"uppercase",letterSpacing:.5}}>${c.l}</th>`)}</tr></thead><tbody>${rows.map((r,ri)=>html`<tr key=${ri} class="tbl-row" style=${{borderBottom:"1px solid #F1F5F9"}}>${cols.map((c,ci)=>html`<td key=${ci} style=${{padding:"10px 14px",color:"#334155"}}>${c.r?c.r(r):r[c.k]}</td>`)}</tr>`)}</tbody></table></div>`;
const SB=({ph,val,onCh})=>html`<div style=${{position:"relative",flex:1,maxWidth:400}}><span style=${{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#9CA3AF"}}>\u{1F50D}</span><input value=${val} onInput=${e=>onCh(e.target.value)} placeholder=${ph} style=${{width:"100%",padding:"10px 14px 10px 38px",border:"1px solid #D1D5DB",borderRadius:8,fontSize:14,outline:"none",background:"#fff",boxSizing:"border-box"}}/></div>`;
const Bt=({children,v,onClick,style:s})=>{const vars={primary:{background:"#1B3A5C",color:"#fff"},success:{background:"#059669",color:"#fff"},danger:{background:"#DC2626",color:"#fff"},outline:{background:"transparent",border:"1px solid #D1D5DB",color:"#374151"}};return html`<button class="btn-hover" onClick=${onClick} style=${{padding:"8px 18px",borderRadius:7,border:"none",fontWeight:600,fontSize:13,cursor:"pointer",display:"inline-flex",alignItems:"center",gap:6,...(vars[v]||vars.primary),...(s||{})}}>${children}</button>`;};
const PH=({title,sub,actions})=>html`<div style=${{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20,flexWrap:"wrap",gap:10}}><div><h2 style=${{margin:0,fontSize:22,fontWeight:800,color:"#0F172A"}}>${title}</h2>${sub&&html`<p style=${{margin:"2px 0 0",fontSize:13,color:"#64748B"}}>${sub}</p>`}</div><div style=${{display:"flex",gap:8,flexWrap:"wrap"}}>${actions}</div></div>`;
const TB=({tabs,active,onCh})=>html`<div style=${{display:"flex",gap:2,borderBottom:"2px solid #E5E7EB",marginBottom:16,overflowX:"auto"}}>${tabs.map(t=>html`<button key=${t.k} onClick=${()=>onCh(t.k)} style=${{padding:"8px 18px",border:"none",background:active===t.k?"#fff":"transparent",borderBottom:active===t.k?"2px solid #1B3A5C":"2px solid transparent",fontWeight:active===t.k?700:400,color:active===t.k?"#1B3A5C":"#64748B",cursor:"pointer",fontSize:13,marginBottom:-2,whiteSpace:"nowrap"}}>${t.l}</button>`)}</div>`;
const MC=({data,color,h,w})=>{h=h||40;w=w||120;const mx=Math.max(...data);return html`<svg width=${w} height=${h} style=${{display:"block"}}><polyline points=${data.map((v,i)=>`${(i/(data.length-1))*w},${h-(v/mx)*h}`).join(" ")} fill="none" stroke=${color||"#3B82F6"} stroke-width="2"/></svg>`;};

/* ═══ SCREENS ═══ */
function SDash({role}){const io=role==="OWNER"||role==="MANAGER";return html`<div><${PH} title="Tableau de bord" sub=${`Vue ${io?"direction":"opérationnelle"} — 5 fev. 2026`}/><div style=${{display:"flex",gap:14,flexWrap:"wrap",marginBottom:20}}><${SC2} label="CA du jour" value="2 456 \u20AC" sub="+12% vs hier" color="#059669" icon="\u{1F4B0}"/><${SC2} label="Commandes" value="18" sub="5 en préparation" color="#1B3A5C" icon="\u{1F4E6}"/><${SC2} label="Panier moyen" value="136 \u20AC" sub="+3% vs S-1" color="#7C3AED" icon="\u{1F6D2}"/><${SC2} label="Marge brute" value=${io?"42.3%":"\u2014"} sub=${io?"Objectif : 40%":"Restreint"} color="#059669" icon="\u{1F4C8}"/></div><div style=${{display:"grid",gridTemplateColumns:"2fr 1fr",gap:14}}><${Cd}><div style=${{fontWeight:700,fontSize:14,marginBottom:12}}>Commandes récentes</div><${DT} cols=${[{l:"N\u00B0",k:"id"},{l:"Client",k:"client"},{l:"Statut",r:r=>html`<${B} s=${r.status}/>`},{l:"Total",r:r=>html`<b>${r.total.toFixed(2)}\u20AC</b>`}]} rows=${ORDERS.slice(0,6)}/><//><div style=${{display:"flex",flexDirection:"column",gap:14}}><${Cd}><div style=${{fontWeight:700,fontSize:14,marginBottom:10}}>Alertes stock bas</div>${PRODUCTS.filter(p=>p.stock<=p.minStock).map(p=>html`<div key=${p.id} style=${{display:"flex",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px solid #F1F5F9",fontSize:13}}><span style=${{color:"#DC2626",fontWeight:600}}>\u26A0\uFE0F ${p.name}</span><span style=${{color:"#6B7280"}}>${p.stock}/${p.minStock}</span></div>`)}<//><${Cd}><div style=${{fontWeight:700,fontSize:14,marginBottom:10}}>Top ventes</div>${PRODUCTS.slice(0,4).map((p,i)=>html`<div key=${p.id} style=${{display:"flex",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px solid #F1F5F9",fontSize:13}}><span>#${i+1} ${p.name}</span><${MC} data=${[3,5,4,7,6,8,9]} color="#10B981" w=${60} h=${20}/></div>`)}<//><${Cd}><div style=${{fontWeight:700,fontSize:14,marginBottom:6}}>CA hebdomadaire</div><${MC} data=${[1200,1800,1600,2100,1900,2400,2200]} color="#3B82F6" w=${220} h=${50}/><//></div></div></div>`;}

function SOrd(){const[s,setS]=useState("");const[tab,setTab]=useState("all");const f=ORDERS.filter(o=>(tab==="all"||o.status===tab)&&(o.id.includes(s)||o.client.toLowerCase().includes(s.toLowerCase())));return html`<div><${PH} title="Commandes" sub=${ORDERS.length+" commandes"} actions=${html`<${Bt} v="primary">\u2795 Nouvelle commande<//>`}/><${TB} tabs=${[{k:"all",l:"Toutes"},{k:"CONFIRMED",l:"Confirmées"},{k:"PREPARING",l:"En préparation"},{k:"READY",l:"Prêtes"},{k:"DELIVERED",l:"Livrées"}]} active=${tab} onCh=${setTab}/><div style=${{marginBottom:14}}><${SB} ph="Rechercher..." val=${s} onCh=${setS}/></div><${DT} cols=${[{l:"N\u00B0",r:r=>html`<b style=${{color:"#1B3A5C"}}>${r.id}</b>`},{l:"Client",k:"client"},{l:"Source",r:r=>html`<span style=${{fontSize:11,padding:"2px 8px",background:r.source==="B2B"?"#DBEAFE":r.source==="POS"?"#FEF3C7":"#E5E7EB",borderRadius:10}}>${r.source}</span>`},{l:"Statut",r:r=>html`<${B} s=${r.status}/>`},{l:"Articles",k:"items"},{l:"Total HT",r:r=>html`<b>${r.total.toFixed(2)}\u20AC</b>`},{l:"Date",k:"date"}]} rows=${f}/></div>`;}

function SNew({isB2B}){const cd=[{n:"Alliance Auto.",ref:"AA-BP-4520",p:32.10,st:120,d:"D+1"},{n:"Autodistribution",ref:"AD-BP-4520",p:33.80,st:85,d:"D+1"},{n:"PHE Europe",ref:"PHE-4520-FR",p:31.50,st:200,d:"D+2"},{n:"Distrigo",ref:"DST-BP4520",p:35.20,st:45,d:"D+1"}];return html`<div><${PH} title=${isB2B?"Passer commande":"Nouvelle commande"} sub="Comparez les sources, ajoutez au panier"/><div style=${{display:"grid",gridTemplateColumns:"1fr 340px",gap:16}}><div><${Cd} style=${{marginBottom:14}}>${!isB2B&&html`<div style=${{marginBottom:14}}><label style=${{fontSize:12,fontWeight:600,color:"#475569",display:"block",marginBottom:4}}>Client</label><select style=${{width:"100%",padding:"8px 12px",border:"1px solid #D1D5DB",borderRadius:8,fontSize:14}}><option>Garage Martin SAS (PRO-15)</option><option>Auto Service Plus</option></select></div>`}<label style=${{fontSize:12,fontWeight:600,color:"#475569",display:"block",marginBottom:4}}>Recherche pièce</label><div style=${{display:"flex",gap:8}}><${SB} ph="Référence, EAN, nom..." val="" onCh=${()=>{}}/><${Bt} v="outline">\u{1F697} Véhicule<//></div><//><${Cd}><div style=${{fontWeight:700,fontSize:14,marginBottom:10}}>\u{1F50E} Comparatif — Plaquettes frein AV</div><div style=${{overflowX:"auto",border:"1px solid #E5E7EB",borderRadius:8}}><table style=${{width:"100%",borderCollapse:"collapse",fontSize:13}}><thead><tr style=${{background:"#F0F7FF"}}>${["Source","Ref","Prix HT","Stock","Délai",""].map(h=>html`<th key=${h} style=${{padding:"10px 12px",textAlign:"left",fontWeight:700,color:"#1B3A5C",fontSize:11,textTransform:"uppercase"}}>${h}</th>`)}</tr></thead><tbody><tr style=${{background:"#F0FDF4",borderBottom:"1px solid #E5E7EB"}}><td style=${{padding:"10px 12px"}}><b style=${{color:"#059669"}}>\u{1F3ED} Stock interne</b></td><td style=${{padding:"10px 12px"}}>BRK-PAD-4520</td><td style=${{padding:"10px 12px",fontWeight:700}}>34.50\u20AC</td><td style=${{padding:"10px 12px"}}><span style=${{color:"#059669",fontWeight:600}}>45</span></td><td style=${{padding:"10px 12px"}}><span style=${{color:"#059669"}}>Immédiat</span></td><td style=${{padding:"10px 12px"}}><${Bt} v="success" style=${{padding:"5px 12px",fontSize:12}}>+ Ajouter<//></td></tr>${cd.map((x,i)=>html`<tr key=${i} style=${{borderBottom:"1px solid #F1F5F9"}}><td style=${{padding:"10px 12px"}}>\u{1F69B} ${x.n}</td><td style=${{padding:"10px 12px",color:"#6B7280"}}>${x.ref}</td><td style=${{padding:"10px 12px",fontWeight:600}}>${x.p.toFixed(2)}\u20AC</td><td style=${{padding:"10px 12px"}}>${x.st}</td><td style=${{padding:"10px 12px",color:"#92400E"}}>${x.d}</td><td style=${{padding:"10px 12px"}}><${Bt} v="outline" style=${{padding:"5px 12px",fontSize:12}}>+ Ajouter<//></td></tr>`)}</tbody></table></div><//></div><div><${Cd} style=${{position:"sticky",top:0}}><div style=${{fontWeight:700,fontSize:15,marginBottom:14}}>\u{1F6D2} Panier</div><div style=${{padding:"10px 0",borderBottom:"1px solid #F1F5F9"}}><div style=${{fontWeight:600,fontSize:13}}>Plaquettes frein AV Bosch</div><div style=${{display:"flex",justifyContent:"space-between",fontSize:12,color:"#6B7280",marginTop:4}}><span>Qty: 2 x 34.50\u20AC</span><b style=${{color:"#0F172A"}}>69.00\u20AC</b></div></div><div style=${{borderTop:"2px solid #E5E7EB",marginTop:12,paddingTop:12}}><div style=${{display:"flex",justifyContent:"space-between",fontSize:13,marginBottom:4}}><span>Sous-total HT</span><b>69.00\u20AC</b></div><div style=${{display:"flex",justifyContent:"space-between",fontSize:13,marginBottom:4}}><span>TVA 20%</span><span>13.80\u20AC</span></div><div style=${{display:"flex",justifyContent:"space-between",fontSize:16,fontWeight:800,marginTop:8,color:"#1B3A5C"}}><span>Total TTC</span><span>82.80\u20AC</span></div></div><${Bt} v="primary" style=${{width:"100%",marginTop:14,justifyContent:"center",padding:12}}>\u2705 Valider la commande<//><//></div></div></div>`;}

function SCat({isB2B}){const[s,setS]=useState("");const[m,setM]=useState("ref");return html`<div><${PH} title=${isB2B?"Catalogue pieces":"Catalogue & Recherche"} sub="Recherche par référence, EAN ou véhicule"/><${Cd} style=${{marginBottom:14}}><${TB} tabs=${[{k:"ref",l:"Référence / EAN"},{k:"vehicle",l:"\u{1F697} Véhicule"},{k:"category",l:"Catégorie"}]} active=${m} onCh=${setM}/>${m==="vehicle"?html`<div style=${{display:"flex",gap:10,flexWrap:"wrap",alignItems:"end"}}>${["Marque","Modèle","Année","Moteur"].map(x=>html`<div key=${x} style=${{flex:1,minWidth:120}}><label style=${{fontSize:11,fontWeight:600,color:"#64748B",display:"block",marginBottom:4}}>${x}</label><select style=${{width:"100%",padding:8,border:"1px solid #D1D5DB",borderRadius:6}}><option>--</option></select></div>`)}<${Bt} v="primary">Rechercher<//></div>`:html`<${SB} ph="Référence, EAN ou nom..." val=${s} onCh=${setS}/>`}<//><${DT} cols=${[{l:"Ref",r:r=>html`<span style=${{fontFamily:"monospace",fontWeight:700,color:"#1B3A5C"}}>${r.ref}</span>`},{l:"Désignation",k:"name"},{l:"Marque",k:"brand"},{l:"Cat.",k:"cat"},{l:"Prix HT",r:r=>html`<b>${isB2B?(r.priceHT*0.85).toFixed(2):r.priceHT.toFixed(2)}\u20AC</b>`},{l:"Stock",r:r=>html`<span style=${{color:r.stock<=r.minStock?"#DC2626":"#059669",fontWeight:600}}>${r.stock}</span>`}]} rows=${PRODUCTS}/></div>`;}

function SPOS(){return html`<div><${PH} title="Caisse — Point de Vente" sub="Session ouverte 08:02" actions=${html`<${Bt} v="danger">\u{1F512} Clôturer<//>`}/><div style=${{display:"grid",gridTemplateColumns:"1fr 380px",gap:16}}><${Cd}><div style=${{marginBottom:14}}><${SB} ph="Scanner code-barres..." val="" onCh=${()=>{}}/></div><${DT} cols=${[{l:"Produit",k:"name"},{l:"Ref",k:"ref"},{l:"Prix",r:r=>r.priceHT.toFixed(2)+"\u20AC"},{l:"Stock",r:r=>html`<span style=${{color:r.stock>10?"#059669":"#DC2626"}}>${r.stock}</span>`},{l:"",r:()=>html`<${Bt} v="success" style=${{padding:"4px 10px",fontSize:11}}>+<//>`}]} rows=${PRODUCTS.slice(0,5)}/><//><${Cd} style=${{background:"#0F172A",color:"#fff"}}><div style=${{fontSize:12,color:"#94A3B8",marginBottom:4}}>Client</div><select style=${{width:"100%",padding:8,borderRadius:6,border:"1px solid #334155",background:"#1E293B",color:"#fff",marginBottom:14}}><option>Client comptoir</option><option>Garage Martin SAS</option></select>${[{n:"Plaquettes frein AV Bosch",q:1,p:34.50},{n:"Filtre huile Mann",q:2,p:12.80}].map((x,i)=>html`<div key=${i} style=${{display:"flex",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid #1E293B"}}><div><div style=${{fontWeight:600,fontSize:13}}>${x.n}</div><div style=${{fontSize:11,color:"#94A3B8"}}>Qty: ${x.q}</div></div><b>${(x.q*x.p).toFixed(2)}\u20AC</b></div>`)}<div style=${{display:"flex",justifyContent:"space-between",fontSize:13,marginTop:10,marginBottom:4}}><span style=${{color:"#94A3B8"}}>Sous-total</span><span>60.10\u20AC</span></div><div style=${{display:"flex",justifyContent:"space-between",fontSize:13,marginBottom:8}}><span style=${{color:"#94A3B8"}}>TVA 20%</span><span>12.02\u20AC</span></div><div style=${{display:"flex",justifyContent:"space-between",fontSize:24,fontWeight:800,padding:"10px 0",borderTop:"2px solid #334155"}}><span>TOTAL</span><span style=${{color:"#34D399"}}>72.12\u20AC</span></div><div style=${{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginTop:12}}><button style=${{padding:14,borderRadius:8,border:"none",background:"#3B82F6",color:"#fff",fontWeight:700,fontSize:15,cursor:"pointer"}}>\u{1F4B3} CB</button><button style=${{padding:14,borderRadius:8,border:"none",background:"#059669",color:"#fff",fontWeight:700,fontSize:15,cursor:"pointer"}}>\u{1F4B6} Espèces</button></div><//></div></div>`;}

function SInv({isB2B}){return html`<div><${PH} title=${isB2B?"Mes factures":"Factures"} sub="Auto-générées à la livraison"/><${DT} cols=${[{l:"N\u00B0",r:r=>html`<b style=${{color:"#1B3A5C"}}>${r.id}</b>`},{l:"Cmd",k:"order"},...(isB2B?[]:[{l:"Client",k:"client"}]),{l:"Total TTC",r:r=>html`<b>${r.total.toFixed(2)}\u20AC</b>`},{l:"Statut",r:r=>html`<${B} s=${r.status}/>`},{l:"PDP",r:r=>html`<span style=${{fontSize:11,color:r.pdp==="Transmise"?"#059669":"#92400E"}}>${r.pdp}</span>`},{l:"Date",k:"date"},{l:"",r:()=>html`<${Bt} v="outline" style=${{padding:"4px 10px",fontSize:11}}>PDF<//>`}]} rows=${INVOICES}/></div>`;}

function SCust(){return html`<div><${PH} title="Clients" sub=${CUSTOMERS.length+" clients B2B"} actions=${html`<${Bt} v="primary">\u2795 Nouveau<//>`}/><${DT} cols=${[{l:"Nom",r:r=>html`<b style=${{color:"#1B3A5C"}}>${r.name}</b>`},{l:"Grille",r:r=>html`<span style=${{fontFamily:"monospace",fontSize:12,background:"#F1F5F9",padding:"2px 6px",borderRadius:4}}>${r.grid}</span>`},{l:"Ville",k:"city"},{l:"Cmd",k:"orders"},{l:"CA",r:r=>html`<b>${r.ca.toLocaleString()}\u20AC</b>`}]} rows=${CUSTOMERS}/></div>`;}

function SQuo(){return html`<div><${PH} title="Devis" actions=${html`<${Bt} v="primary">\u2795 Nouveau devis<//>`}/><${DT} cols=${[{l:"N\u00B0",r:r=>html`<b style=${{color:"#1B3A5C"}}>${r.id}</b>`},{l:"Client",k:"client"},{l:"Statut",r:r=>html`<${B} s=${r.status}/>`},{l:"Total HT",r:r=>html`<b>${r.total.toFixed(2)}\u20AC</b>`},{l:"Date",k:"date"},{l:"Validite",k:"validUntil"}]} rows=${QUOTES}/></div>`;}

function SStk(){return html`<div><${PH} title="Gestion du stock" sub="Entrepôt principal" actions=${html`<${Bt} v="primary">\u2696\uFE0F Ajustement<//>`}/><div style=${{display:"flex",gap:14,marginBottom:14,flexWrap:"wrap"}}><${SC2} label="Références" value=${PRODUCTS.length} icon="\u{1F4E6}"/><${SC2} label="Valeur stock" value="18 420\u20AC" icon="\u{1F4B0}"/><${SC2} label="Alertes" value=${PRODUCTS.filter(p=>p.stock<=p.minStock).length} color="#DC2626" icon="\u26A0\uFE0F"/></div><${DT} cols=${[{l:"Ref",r:r=>html`<span style=${{fontFamily:"monospace",fontWeight:700}}>${r.ref}</span>`},{l:"Désignation",k:"name"},{l:"Stock",r:r=>html`<span style=${{fontWeight:700,color:r.stock<=r.minStock?"#DC2626":"#059669"}}>${r.stock}</span>`},{l:"Min",k:"minStock"},{l:"Cout",r:r=>r.costHT.toFixed(2)+"\u20AC"},{l:"Valeur",r:r=>html`<b>${(r.stock*r.costHT).toFixed(2)}\u20AC</b>`},{l:"",r:r=>r.stock<=r.minStock?html`<span style=${{color:"#DC2626"}}>\u26A0\uFE0F BAS</span>`:html`<span style=${{color:"#059669"}}>\u2705</span>`}]} rows=${PRODUCTS}/></div>`;}

function SRet(){return html`<div><${PH} title="Retours clients"/><${DT} cols=${[{l:"N\u00B0",r:r=>html`<b style=${{color:"#1B3A5C"}}>${r.id}</b>`},{l:"Cmd",k:"order"},{l:"Client",k:"client"},{l:"Statut",r:r=>html`<${B} s=${r.status}/>`},{l:"Motif",k:"reason"},{l:"Date",k:"date"}]} rows=${RETURNS}/></div>`;}

function SSup(){return html`<div><${PH} title="Fournisseurs" sub="5 connecteurs API" actions=${html`<${Bt} v="primary">\u2795 Ajouter<//>`}/><${DT} cols=${[{l:"Fournisseur",r:r=>html`<b style=${{color:"#1B3A5C"}}>${r.name}</b>`},{l:"API",r:r=>html`<span style=${{fontFamily:"monospace",background:r.type==="REST"?"#DBEAFE":"#FEF3C7",padding:"2px 8px",borderRadius:4,fontSize:11}}>${r.type}</span>`},{l:"Statut",r:r=>html`<span style=${{color:r.status==="active"?"#059669":"#F59E0B",fontWeight:600}}>${r.status==="active"?"\u2705 Actif":"\u26A0\uFE0F"}</span>`},{l:"Prio",k:"priority"}]} rows=${SUPPLIERS}/></div>`;}

function SAU(){const u=[{n:"Max (Owner)",e:"max@mecadepot.fr",r:"OWNER",ll:"08:30"},{n:"Sophie Leroy",e:"sophie@mecadepot.fr",r:"MANAGER",ll:"07:45"},{n:"Julien Moreau",e:"julien@mecadepot.fr",r:"COMMERCIAL",ll:"17:20"},{n:"Ahmed Benali",e:"ahmed@mecadepot.fr",r:"COUNTER_AGENT",ll:"08:00"},{n:"Pierre Dupont",e:"pierre@mecadepot.fr",r:"WAREHOUSE_KEEPER",ll:"06:30"},{n:"Marie Laurent",e:"marie@mecadepot.fr",r:"ACCOUNTING",ll:"16:00"}];return html`<div><${PH} title="Utilisateurs" sub="11 rôles" actions=${html`<${Bt} v="primary">\u2795 Nouveau<//>`}/><${DT} cols=${[{l:"Nom",r:r=>html`<b>${r.n}</b>`},{l:"Email",r:r=>r.e},{l:"Rôle",r:r=>html`<span style=${{fontSize:11,padding:"2px 8px",background:(ROLES[r.r]?.color||"#666")+"22",color:ROLES[r.r]?.color,borderRadius:10,fontWeight:700}}>${ROLES[r.r]?.icon} ${r.r}</span>`},{l:"Dernier accès",r:r=>r.ll}]} rows=${u}/></div>`;}

function SAS(){return html`<div><${PH} title="Paramètres" sub="Configuration ERP"/><div style=${{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16}}><${Cd}><h3 style=${{margin:"0 0 14px",fontSize:15}}>\u{1F3E2} Entreprise</h3>${[["Raison sociale","MECADEPOT SAS"],["SIRET","123 456 789 00012"],["TVA","FR12345678900"]].map(([l,v])=>html`<div key=${l} style=${{marginBottom:10}}><label style=${{fontSize:11,fontWeight:600,color:"#64748B",display:"block",marginBottom:2}}>${l}</label><input defaultValue=${v} style=${{width:"100%",padding:8,border:"1px solid #D1D5DB",borderRadius:6,fontSize:13,boxSizing:"border-box"}}/></div>`)}<//><${Cd}><h3 style=${{margin:"0 0 14px",fontSize:15}}>\u{1F50C} PDP & Paiement</h3><div style=${{marginBottom:10}}><label style=${{fontSize:11,fontWeight:600,color:"#64748B"}}>PDP</label><select style=${{width:"100%",padding:8,border:"1px solid #D1D5DB",borderRadius:6,marginTop:2}}><option>Pennylane</option><option>Tiime</option></select></div><span style=${{color:"#059669",fontWeight:600,fontSize:13}}>\u2705 PDP + Stripe connectes</span><//></div></div>`;}

function SLog(){const l=[{t:"08:32",u:"Max",a:"LOGIN",d:"Connexion"},{t:"08:30",u:"Ahmed",a:"POS_OPEN",d:"Caisse 200\u20AC"},{t:"08:28",u:"Pierre",a:"DELIVER",d:"CMD-142 livré"},{t:"08:25",u:"Julien",a:"DISCOUNT",d:"5% CMD-141"},{t:"08:20",u:"Sophie",a:"RETURN",d:"RET-012 OK"}];return html`<div><${PH} title="Logs d'audit"/><${DT} cols=${[{l:"Heure",r:r=>html`<span style=${{fontFamily:"monospace"}}>${r.t}</span>`},{l:"User",r:r=>html`<b>${r.u}</b>`},{l:"Action",r:r=>html`<span style=${{fontFamily:"monospace",fontSize:11,background:"#F1F5F9",padding:"2px 6px",borderRadius:4}}>${r.a}</span>`},{l:"Détail",r:r=>r.d}]} rows=${l}/></div>`;}

function SExp(){return html`<div><${PH} title="Exports comptables"/><div style=${{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14}}>${[{i:"\u{1F9FE}",t:"Factures"},{i:"\u{1F4CB}",t:"Commandes"},{i:"\u{1F4CA}",t:"FEC (V3)"},{i:"\u{1F4C8}",t:"CA par client"},{i:"\u{1F4B0}",t:"Marges"},{i:"\u{1F504}",t:"Avoirs"}].map((x,j)=>html`<${Cd} key=${j} style=${{textAlign:"center"}}><div style=${{fontSize:32,marginBottom:8}}>${x.i}</div><div style=${{fontWeight:700,marginBottom:12}}>${x.t}</div><${Bt} v="primary" style=${{width:"100%",justifyContent:"center"}}>Générer<//><//>`)}</div></div>`;}

function SCN(){return html`<div><${PH} title="Avoirs"/><${DT} cols=${[{l:"N\u00B0",r:()=>html`<b style=${{color:"#1B3A5C"}}>CRN-2026-00015</b>`},{l:"Facture",r:()=>"INV-2026-00082"},{l:"Client",r:()=>"MecaPro SARL"},{l:"Montant",r:()=>html`<b style=${{color:"#DC2626"}}>-156.00\u20AC</b>`},{l:"Date",r:()=>"2026-01-28"}]} rows=${[{}]}/></div>`;}
function SAP(){const g=[{id:"PRO-20",n:"Premium (-20%)",c:2,r:"-20%"},{id:"PRO-15",n:"Standard (-15%)",c:5,r:"-15%"},{id:"PRO-10",n:"Découverte (-10%)",c:8,r:"-10%"},{id:"STD",n:"Public",c:12,r:"0%"}];return html`<div><${PH} title="Grilles tarifaires" actions=${html`<${Bt} v="primary">\u2795 Nouvelle<//>`}/><${DT} cols=${[{l:"Code",r:r=>html`<b style=${{fontFamily:"monospace",color:"#1B3A5C"}}>${r.id}</b>`},{l:"Nom",r:r=>r.n},{l:"Clients",r:r=>r.c},{l:"Remise",r:r=>r.r}]} rows=${g}/></div>`;}
function SWH({type}){const isDel=type==="d";const rows=isDel?[{id:"CMD-141",c:"Auto Service Plus",s:"READY",n:3},{id:"CMD-139",c:"MecaPro SARL",s:"PREPARING",n:8}]:[{id:"SO-045",c:"Alliance Automotive",s:"READY",n:12},{id:"SO-044",c:"Autodistribution",s:"CONFIRMED",n:5}];return html`<div><${PH} title=${isDel?"Préparations":"Réceptions"}/><${DT} cols=${[{l:"Ref",r:r=>html`<b style=${{color:"#1B3A5C"}}>${r.id}</b>`},{l:isDel?"Client":"Fournisseur",r:r=>r.c},{l:"Statut",r:r=>html`<${B} s=${r.s}/>`},{l:"Articles",r:r=>r.n}]} rows=${rows}/></div>`;}
function SAPI(){return html`<div><${PH} title="Config API" sub="Alliance Automotive"/><${Cd}><div style=${{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16}}>${[["Endpoint","https://api.alliance-auto.com/v2"],["Timeout","3000ms"],["API Key","ak_xxxx..."],["Priorité","1"]].map(([l,v])=>html`<div key=${l}><label style=${{fontSize:11,fontWeight:600,color:"#64748B",display:"block",marginBottom:2}}>${l}</label><input defaultValue=${v} style=${{width:"100%",padding:8,border:"1px solid #D1D5DB",borderRadius:6,fontSize:13,boxSizing:"border-box"}}/></div>`)}</div><div style=${{marginTop:14,padding:10,background:"#F0FDF4",borderRadius:6,fontSize:13,color:"#059669"}}>\u2705 OK — 245ms</div><//></div>`;}
function SPO(){return html`<div><${PH} title="Bons de commande (V2)" actions=${html`<${Bt} v="primary">\u2795 BC<//>`}/><div style=${{padding:14,background:"#FEF3C7",borderRadius:8,marginBottom:14,fontSize:13,color:"#92400E"}}>Workflow: DRAFT \u2192 SUBMITTED \u2192 APPROVED \u2192 ORDERED \u2192 RECEIVED</div><${DT} cols=${[{l:"N\u00B0",r:()=>html`<b style=${{color:"#1B3A5C"}}>PO-2026-00023</b>`},{l:"Fournisseur",r:()=>"Alliance Automotive"},{l:"Statut",r:()=>html`<${B} s="DRAFT"/>`},{l:"Total",r:()=>html`<b>2 340\u20AC</b>`}]} rows=${[{}]}/></div>`;}
function SB2D(){return html`<div><${PH} title="Bienvenue, Garage Martin SAS"/><div style=${{display:"flex",gap:14,flexWrap:"wrap",marginBottom:20}}><${SC2} label="Commandes" value="12" icon="\u{1F4E6}"/><${SC2} label="En cours" value="3" color="#F59E0B" icon="\u{1F504}"/><${SC2} label="Impayées" value="1" color="#DC2626" icon="\u{1F9FE}"/><${SC2} label="Total mois" value="4 560\u20AC" color="#059669" icon="\u{1F4B0}"/></div><div style=${{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14}}><${Cd}><div style=${{fontWeight:700,marginBottom:12}}>Dernières commandes</div><${DT} cols=${[{l:"N\u00B0",r:r=>html`<b style=${{color:"#1B3A5C"}}>${r.id}</b>`},{l:"Statut",r:r=>html`<${B} s=${r.status}/>`},{l:"Total",r:r=>r.total.toFixed(2)+"\u20AC"}]} rows=${ORDERS.filter(o=>o.client==="Garage Martin SAS").slice(0,3)}/><//><${Cd}><div style=${{fontWeight:700,marginBottom:12}}>Actions rapides</div><div style=${{display:"flex",flexDirection:"column",gap:8}}><${Bt} v="primary" style=${{justifyContent:"center"}}>\u{1F6D2} Commander<//><${Bt} v="outline" style=${{justifyContent:"center"}}>\u{1F50D} Rechercher<//></div><//></div></div>`;}
function SB2U(){return html`<div><${PH} title="Utilisateurs" actions=${html`<${Bt} v="primary">\u2795 Ajouter<//>`}/><${DT} cols=${[{l:"Nom",r:()=>html`<b>Jean Martin</b>`},{l:"Email",r:()=>"jean@garagemartin.fr"},{l:"Rôle",r:()=>html`<${B} s="APPROVED"/>`},{l:"Accès",r:()=>"09:00"}]} rows=${[{},{}]}/></div>`;}
function SB2P(){return html`<div><${PH} title="Profil entreprise"/><${Cd}><div style=${{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16}}>${[["Raison sociale","Garage Martin SAS"],["SIRET","987 654 321 00045"],["Grille","PRO-15 (-15%)"],["Email","contact@garagemartin.fr"],["Adresse","12 rue des Ateliers"],["Tel","04 76 XX XX XX"]].map(([l,v])=>html`<div key=${l}><label style=${{fontSize:11,fontWeight:600,color:"#64748B",display:"block",marginBottom:2}}>${l}</label><div style=${{fontSize:14,fontWeight:500}}>${v}</div></div>`)}</div><//></div>`;}
function SFB(){return html`<div style=${{padding:40,textAlign:"center",color:"#9CA3AF"}}><div style=${{fontSize:48,marginBottom:16}}>\u{1F6A7}</div><div style=${{fontSize:18,fontWeight:600}}>Écran en construction</div></div>`;}

function Router({screen,role}){
  const m={"dashboard":html`<${SDash} role=${role}/>`,"orders":html`<${SOrd}/>`,"orders-new":html`<${SNew} isB2B=${false}/>`,"quotes":html`<${SQuo}/>`,"customers":html`<${SCust}/>`,"catalog":html`<${SCat} isB2B=${false}/>`,"products":html`<${SCat} isB2B=${false}/>`,"inventory":html`<${SStk}/>`,"inventory-receive":html`<${SWH} type="r"/>`,"invoices":html`<${SInv} isB2B=${false}/>`,"credit-notes":html`<${SCN}/>`,"exports":html`<${SExp}/>`,"returns":html`<${SRet}/>`,"pos":html`<${SPOS}/>`,"suppliers":html`<${SSup}/>`,"suppliers-api":html`<${SAPI}/>`,"supplier-orders":html`<${SWH} type="r"/>`,"purchase-orders":html`<${SPO}/>`,"warehouse-deliveries":html`<${SWH} type="d"/>`,"warehouse-receptions":html`<${SWH} type="r"/>`,"admin-users":html`<${SAU}/>`,"admin-settings":html`<${SAS}/>`,"admin-pricing":html`<${SAP}/>`,"admin-logs":html`<${SLog}/>`,"b2b-dashboard":html`<${SB2D}/>`,"b2b-catalog":html`<${SCat} isB2B=${true}/>`,"b2b-orders":html`<${SOrd}/>`,"b2b-orders-new":html`<${SNew} isB2B=${true}/>`,"b2b-invoices":html`<${SInv} isB2B=${true}/>`,"b2b-users":html`<${SB2U}/>`,"b2b-profile":html`<${SB2P}/>`};
  return m[screen]||html`<${SFB}/>`;
}

function App(){
  const[role,setRole]=useState("OWNER");
  const[screen,setScreen]=useState("dashboard");
  const[col,setCol]=useState(false);
  const menu=MENU_BY_ROLE[role]||[];
  const isB2B=role.startsWith("B2B");
  useEffect(()=>{if(menu[0])setScreen(menu[0]);},[role]);
  const groups={};menu.forEach(k=>{const m=SM[k];if(m){if(!groups[m.group])groups[m.group]=[];groups[m.group].push({key:k,...m});}});

  return html`<div style=${{display:"flex",height:"100vh",background:"#F1F5F9",overflow:"hidden"}}>
    <div style=${{width:col?60:240,background:isB2B?"#0C4A6E":"#0F172A",color:"#fff",display:"flex",flexDirection:"column",transition:"width 0.2s",flexShrink:0,overflow:"hidden"}}>
      <div style=${{padding:col?"16px 10px":"16px 18px",borderBottom:"1px solid #1E293B",display:"flex",alignItems:"center",gap:10}}>
        <div style=${{width:32,height:32,borderRadius:8,background:isB2B?"#0EA5E9":"#E8B931",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:900,fontSize:14,color:"#0F172A",flexShrink:0}}>M</div>
        ${!col&&html`<div><div style=${{fontWeight:800,fontSize:14,letterSpacing:1}}>MECADEPOT</div><div style=${{fontSize:10,color:"#94A3B8"}}>${isB2B?"Portail B2B":"ERP"}</div></div>`}
      </div>
      <div style=${{flex:1,overflowY:"auto",padding:"8px 0"}}>
        ${Object.entries(groups).map(([g,items])=>html`<div key=${g}>
          ${!col&&html`<div style=${{padding:"10px 18px 4px",fontSize:10,fontWeight:700,color:"#475569",textTransform:"uppercase",letterSpacing:1}}>${g}</div>`}
          ${items.map(it=>html`<button key=${it.key} class="sidebar-btn" onClick=${()=>setScreen(it.key)} style=${{width:"100%",display:"flex",alignItems:"center",gap:10,padding:col?"8px 18px":"7px 18px",border:"none",background:screen===it.key?(isB2B?"#0369A1":"#1E293B"):"transparent",color:screen===it.key?"#fff":"#94A3B8",cursor:"pointer",fontSize:13,fontWeight:screen===it.key?600:400,borderLeft:screen===it.key?"3px solid "+(isB2B?"#38BDF8":"#E8B931"):"3px solid transparent",textAlign:"left"}}><span style=${{fontSize:16,flexShrink:0}}>${it.icon}</span>${!col&&html`<span>${it.label}</span>`}</button>`)}
        </div>`)}
      </div>
      <button onClick=${()=>setCol(!col)} style=${{padding:12,border:"none",borderTop:"1px solid #1E293B",background:"transparent",color:"#64748B",cursor:"pointer",fontSize:16}}>${col?"\u2192":"\u2190"}</button>
    </div>
    <div style=${{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"}}>
      <div style=${{height:52,background:"#fff",borderBottom:"1px solid #E5E7EB",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 20px",flexShrink:0}}>
        <div style=${{display:"flex",alignItems:"center",gap:8}}>
          <span style=${{fontSize:12,color:"#64748B"}}>Rôle :</span>
          <select value=${role} onChange=${e=>setRole(e.target.value)} style=${{padding:"5px 10px",border:"1px solid #D1D5DB",borderRadius:6,fontSize:13,fontWeight:600,background:(ROLES[role]?.color||"#666")+"15",color:ROLES[role]?.color}}>
            ${Object.entries(ROLES).map(([k,v])=>html`<option key=${k} value=${k}>${v.icon} ${v.label} — ${v.desc}</option>`)}
          </select>
        </div>
        <div style=${{display:"flex",alignItems:"center",gap:8}}>
          <div style=${{width:32,height:32,borderRadius:"50%",background:ROLES[role]?.color,display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontWeight:700,fontSize:13}}>${ROLES[role]?.icon}</div>
          <div><div style=${{fontSize:13,fontWeight:600}}>Max</div><div style=${{fontSize:10,color:"#9CA3AF"}}>${ROLES[role]?.label}</div></div>
        </div>
      </div>
      <div style=${{padding:"8px 20px",fontSize:12,color:"#94A3B8",background:"#F8FAFC",borderBottom:"1px solid #F1F5F9"}}>${isB2B?"B2B":"ERP"} / ${SM[screen]?.group} / <b style=${{color:"#0F172A"}}>${SM[screen]?.label}</b><span style=${{float:"right",fontSize:11}}>${menu.length} écrans ${ROLES[role]?.label}</span></div>
      <div style=${{flex:1,overflow:"auto",padding:20}}><${Router} screen=${screen} role=${role}/></div>
    </div>
  </div>`;
}

ReactDOM.createRoot(document.getElementById("root")).render(html`<${App}/>`);
</script>
</body>
</html>
